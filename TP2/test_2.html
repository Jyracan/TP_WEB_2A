<!DOCTYPE html>

<html>
	<head>
		<meta charset="utf-8" />
		<title>Test nÂ°2</title>
	</head>
	<script type="text/javascript">	
		var intervalID;
		var delayID;
		var c;
		var foward=true;
		var lastTimeItMoved=new Date();
		var updateTime=100;

		function rectangle(x,y){
		  var canvas = document.getElementById("canvas1"); 
		  var context = canvas.getContext("2d");
		  context.clearRect(0, 0, canvas.width, canvas.height);
		  context.beginPath();
		  context.fillRect(x,y,100,100);
		  context.fillStyle="red";
		  context.stroke();
		}
		function start(){
			c=0;
			intervalID=setInterval(moveSquare, 100);
			clearInterval(delayID);
		}

		function moveSquare(){
			pausecomp(10);
			curDate = new Date();
			console.log(String((curDate-lastTimeItMoved)/updateTime))
			pas=10*((curDate-lastTimeItMoved)/updateTime);
			if (foward){
				c+=pas;	
			}
			else{
				c-=pas;
			}
			var larg = (document.body.clientWidth);
			if(c>larg-100){
				foward=false;
			}
			if(c<0){
				foward=true;
			} 
			lastTimeItMoved=new Date();
			rectangle(c,0);
 		}
		function pausecomp(millis) {
			var date = new Date();
			var curDate = null;
			do { 
				curDate = new Date(); 
			} while(curDate-date < millis);
		}
		

		function letsStart(){
			delayID = setInterval(start,updateTime);
		}
	</script>
	<body onload="letsStart()">

    <canvas id="canvas1" width="10000" height="100"></canvas>

	</body>

</html>
