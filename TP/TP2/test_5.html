<!DOCTYPE html>

<html>
	<head>
		<meta charset="utf-8" />
		<title>Test nÂ°5</title>
	</head>
	<script type="text/javascript">	
		var canvas;
		var timeStamp=new Date();
		var c=0;
		var foward=true;
		var lastTimeItMoved=new Date();
		var updateTime=100;


		function rectangle(x,y){
		  canvas = document.getElementById("canvas1"); 
		  context = canvas.getContext("2d");
		  context.clearRect(0, 0, canvas.width, canvas.height);
		  context.beginPath();
		  context.fillRect(x,y,100,100);
		  context.fillStyle="red";
		  context.stroke();
		}

		function moveSquare(){
			curDate = new Date();
			pas=10*((curDate-lastTimeItMoved)/updateTime);
			if (foward){
				c+=pas;	
			}
			else{
				c-=pas;
			}
			var larg = (document.body.clientWidth);
			if(c>larg-100){
				foward=false;
			}
			if(c<0){
				foward=true;
			} 
			lastTimeItMoved=new Date();
			rectangle(c,0);
			setTimeout(requestAnimationFrame(moveSquare), 3000);
 		}

	</script>
	<body onload="requestAnimationFrame(moveSquare)">

    <canvas id="canvas1" width="10000" height="100"></canvas>

	</body>

</html>
